<p id="notice"><%= notice %></p>

<button type="button" class="btn btn-light w-100">
  <h3>勤怠状況一覧</h3>
</button> 

<%= render 'shared/date' %>

<div class="pagination justify-content-center">
  <h4><%= paginate @attendances %></h4>
</div>

<table class="table">
    <thead>
      <tr>
        <th scope="col">名前</th>
        <th scope="col">出勤日</th>
        <th scope="col">出勤時間</th>
        <th scope="col">退勤時間</th>
        <th scope="col">勤務時間</th>
        <th scope="col">編集</th>
        <th scope="col">削除</th>
        <th colspan="5"></th>
      </tr>
    </thead>

    <tbody>
      <% @attendances.each do |attendance| %>
        <tr>
          <td>
            <% if attendance.user == current_user %>
              <div class="p-3 bg-success text-white">
                <%= "#{attendance.user.name} (自分)" %>
              </div>
            <% else %>
              <%= attendance.user.name %>
            <% end %>
          </td>
          
          <td>
            <%= attendance.start_at.strftime("%Y年%m月%d日") %>
          </td>
          
          <td>
            <% if attendance.start_at.present? %>
              <%= attendance.start_at.strftime("%H:%M") %>
            <% else %>まだ出勤打刻してないよ
            <% end %>
          </td>
          
          <td>
            <% if attendance.end_at.present? %>
              <%= attendance.end_at.strftime("%H:%M") %>
            <% else %>まだ退勤打刻してないよ！
            <% end %>
          </td>
          
          <td>
            <% if attendance.start_at.present? && attendance.end_at.present? %>
              <%= "#{(attendance.time_diff / 3600).round}時間#{(attendance.time_diff / 60).round}分" %>
            <% else %>打刻漏れ！
            <% end %>
          </td>
          
          <td>
            <%= link_to '編集', edit_attendance_path(attendance) , class: 'btn btn-primary' %>
          </td>

          <td>
            <% if current_user.is_admin? %>
              <%= link_to "削除", attendance, method: :delete, data: { confirm: "本当に削除しますか？" }, class: 'btn btn-primary' %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
</table>